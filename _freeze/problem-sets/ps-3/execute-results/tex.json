{
  "hash": "41cb72068a6ac97ec68244bde86099db",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problem Set 3: Multiple and Logistic Regression\"\nauthor: \"Your Name\"\nformat:\n  html: default\n  pdf: default\n---\n\n\n\n\n\n\n\n\n\n\nThe National Health and Nutrition Examination Survey (NHANES) is a survey conducted annually by the US Centers for Disease Control and Prevention (CDC) involving about 10,000 Americans aged 21 and older. In this problem set, you will use a data set obtained by randomly sampling 500 cases from the 10,000 NHANES survey participants. This new data set is called **nhanes_samp_adult_500** and is available online at \\url{https://www.openintro.org/data/csv/nhanes.samp.adult.500.csv}.\n\n## Importing the Data\n\nUp to this point in this course we have been using data frames that we either created in R or loaded from some package. In this problem set, you will use data from an online source. You will import this data in your workspace as a tibble. Tibbles are same as data frames but with several advantages such as\n\n-   They load faster than data frames.\n\n-   Allow use of non-standard variable names (i.e., variables can have sapces and can start with a number)\n\n-   Allow you to have columns as lists.\n\nTo import the data set into your work space, use the command `read_csv()` which imports the data as a tibble. So you know, the command `read.csv()` loads data as a data frame. As noted earlier, the data is stored on a website and we have the link (URL). Use the command below to load the data into your workspace. Note that we are naming the data **nhanes_samp_adult_500**.\n\n\n\n\n\n\n\n\n\n\n\n\n\nIf you data loads properly, it is highly recommended that you take some time to study it so you understand its context and variables. Doing this will make your analyses easier and interpretations will be meaningful.\n\n## Problem 1 (Linear Regression)\n\nSeveral studies point out that maintaining a healthy weight is an important part of well being. The goal in this problem is to identify, via linear regression, the most important factors that can determine someone's weight. Here is a list of the variables you will consider in this problem:\n\n**PhysActive**: A categorical variable coded as **Yes** if the participant does moderate or vigorous-intensity sports, fitness, or recreational activities, and **No** if otherwise.\n\n**`Height`**: A numerical variable measuring height in cm.\n\n**`SleepHrsNight`**: A numerical variable representing the average sleep time per night in hours.\n\n**`AgeMonths`**: A numerical variable giving someone's age in months.\n\n**`MaritalStatus`**: A categorical variable with levels Divorced, LivePartner, Married, NeverMarried, Separated, and Widowed.\n\n**`Education`**: A categorical variable with levels 8th Grade 9 - 11th Grade, High School, Some College, and College Grad.\n\n**`Gender`**: a categorical variable with levels female, male.\n\nAs we have learned in this course, having a lot of predictors does not necessarily mean you have a great model. You are going to start by fitting a model with all predictors listed above and then perform model selection (backward elimination) to come up with the ''best model'' for predicting weight.\n\na)  Create a model for predicting weight based on all variables in the list above. Based on this model, what factor has the most influence on weight? What factor has the least influence?\n\n<!--\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nModel_2<- lm(Weight ~PhysActive\n             + Height\n             + SleepHrsNight\n             + AgeMonths\n             + MaritalStatus\n             + Education\n             + Gender,\n               data=nhanes_samp_adult_500)\ntidy(Model_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15 x 5\n   term                        estimate std.error statistic       p.value\n   <chr>                          <dbl>     <dbl>     <dbl>         <dbl>\n 1 (Intercept)               -134.       34.9       -3.83   0.000170     \n 2 PhysActiveYes               -7.45      3.22      -2.31   0.0216       \n 3 Height                       1.29      0.210      6.14   0.00000000384\n 4 SleepHrsNight               -0.141     1.05      -0.135  0.893        \n 5 AgeMonths                    0.00563   0.00870    0.647  0.519        \n 6 MaritalStatusLivePartner    11.1       7.34       1.51   0.133        \n 7 MaritalStatusMarried         4.54      5.19       0.875  0.383        \n 8 MaritalStatusNeverMarried   10.5       6.21       1.69   0.0920       \n 9 MaritalStatusSeparated      -7.19     10.4       -0.690  0.491        \n10 MaritalStatusWidowed         5.67      8.51       0.666  0.506        \n11 Education9 - 11th Grade      0.160     6.44       0.0249 0.980        \n12 EducationCollege Grad        0.983     6.18       0.159  0.874        \n13 EducationHigh School         1.40      6.24       0.224  0.823        \n14 EducationSome College        2.62      6.18       0.424  0.672        \n15 Gendermale                  -9.21      4.12      -2.24   0.0263       \n```\n\n\n:::\n:::\n\n\n\n\n\n-->\n\n<!-- rewrite these solutions:\n    -   Predictors: MaritalStatusSeparated;\n\n    -   MaritalStatusWidowed;\n\n    -   Education9 - 11th Grade;\n\n    -   EducationCollege Grad;\n\n    -   EducationHigh School;\n\n    -   EducationSome College;\n\n    -   SleepHrsNight;\n\n    -   AgeMonths;\n\n    -   maritalStatusLive Partner;\n\n    -   maritalStatusNever Married;\n\n    -   MaritalStatusMarried\n-->\n\n<!--\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nModel_SlpHrNight<- lm(Weight ~PhysActive\n             + Height\n            # + SleepHrsNight\n             + AgeMonths\n             + MaritalStatus\n             + Education\n             + Gender,\n               data=nhanes_samp_adult_500)\ntidy(Model_SlpHrNight)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 x 5\n   term                        estimate std.error statistic      p.value\n   <chr>                          <dbl>     <dbl>     <dbl>        <dbl>\n 1 (Intercept)               -124.       34.2        -3.62  0.000364    \n 2 PhysActiveYes               -6.82      3.21       -2.12  0.0348      \n 3 Height                       1.22      0.207       5.90  0.0000000136\n 4 AgeMonths                    0.00421   0.00867     0.485 0.628       \n 5 MaritalStatusLivePartner    10.8       7.22        1.49  0.137       \n 6 MaritalStatusMarried         4.26      5.20        0.819 0.414       \n 7 MaritalStatusNeverMarried    8.27      6.15        1.34  0.181       \n 8 MaritalStatusSeparated      -7.67     10.5        -0.734 0.464       \n 9 MaritalStatusWidowed         5.85      8.55        0.684 0.495       \n10 Education9 - 11th Grade      0.956     6.46        0.148 0.882       \n11 EducationCollege Grad        1.70      6.19        0.274 0.784       \n12 EducationHigh School         2.26      6.26        0.361 0.718       \n13 EducationSome College        2.30      6.20        0.372 0.710       \n14 Gendermale                  -7.90      4.08       -1.94  0.0539      \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nModel_Education<- lm(Weight ~PhysActive\n             + Height\n          #  + SleepHrsNight\n             + AgeMonths\n             + MaritalStatus\n          #  + Education\n             + Gender,\n               data=nhanes_samp_adult_500)\ntidy(Model_Education)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 x 5\n   term                        estimate std.error statistic  p.value\n   <chr>                          <dbl>     <dbl>     <dbl>    <dbl>\n 1 (Intercept)               -126.       33.0        -3.83  1.66e- 4\n 2 PhysActiveYes               -6.95      2.98       -2.33  2.05e- 2\n 3 Height                       1.25      0.194       6.45  6.66e-10\n 4 AgeMonths                    0.00373   0.00843     0.442 6.59e- 1\n 5 MaritalStatusLivePartner    10.4       7.01        1.49  1.38e- 1\n 6 MaritalStatusMarried         3.98      5.02        0.792 4.29e- 1\n 7 MaritalStatusNeverMarried    8.07      5.94        1.36  1.76e- 1\n 8 MaritalStatusSeparated      -7.85     10.2        -0.769 4.43e- 1\n 9 MaritalStatusWidowed         4.99      8.17        0.610 5.42e- 1\n10 Gendermale                  -8.26      3.89       -2.12  3.47e- 2\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nModel_Age <- lm(Weight ~PhysActive\n             + Height\n          #  + SleepHrsNight\n          #  + AgeMonths\n             + MaritalStatus\n          #  + Education\n             + Gender,\n               data=nhanes_samp_adult_500)\ntidy(Model_Age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 x 5\n  term                      estimate std.error statistic  p.value\n  <chr>                        <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                -60.7      19.0     -3.19   1.53e- 3\n2 PhysActiveYes               -6.35      1.75    -3.62   3.21e- 4\n3 Height                       0.881     0.117    7.56   1.99e-13\n4 MaritalStatusLivePartner     0.178     3.97     0.0448 9.64e- 1\n5 MaritalStatusMarried        -1.52      2.89    -0.527  5.99e- 1\n6 MaritalStatusNeverMarried   -0.165     3.38    -0.0489 9.61e- 1\n7 MaritalStatusSeparated      -0.304     5.48    -0.0556 9.56e- 1\n8 MaritalStatusWidowed        -0.571     4.31    -0.132  8.95e- 1\n9 Gendermale                  -0.274     2.39    -0.115  9.09e- 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nModel_Marital <- lm(Weight ~PhysActive\n             + Height\n          #  + SleepHrsNight\n          #  + AgeMonths\n          #  + MaritalStatus\n          #  + Education\n             + Gender,\n               data=nhanes_samp_adult_500)\ntidy(Model_Marital)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 5\n  term          estimate std.error statistic  p.value\n  <chr>            <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    -63.0      18.6      -3.38  7.70e- 4\n2 PhysActiveYes   -6.34      1.71     -3.70  2.43e- 4\n3 Height           0.890     0.115     7.75  5.23e-14\n4 Gendermale      -0.477     2.36     -0.202 8.40e- 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nModel_2_done <- lm(Weight ~PhysActive\n             + Height,\n               data=nhanes_samp_adult_500)\ntidy(Model_2_done)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 5\n  term          estimate std.error statistic  p.value\n  <chr>            <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    -60.5     14.0        -4.32 1.89e- 5\n2 PhysActiveYes   -6.35     1.71       -3.71 2.33e- 4\n3 Height           0.874    0.0833     10.5  2.15e-23\n```\n\n\n:::\n:::\n\n\n\n\n\n-->\n\nb)  What is the R-squared value of the model in part (a) above? Interpret the value in the context of the data.\n\nc) Perform model selection (backward elimination) to come up with the ''best model'' for predicting weight. Write down the equation of the model. You do not need to show all the steps of the backward elimination process but you should explain these steps here in brief.\n\nd) Interpret the intercept and all slopes in the final model from part (c). \n\n<!--\n    -   Intercept: No practical meaning for the intercept.\n\n    -   PhysActiveYes: On average, physically active individuals of the same height weigh 6.25 Kg less than their counterparts that are not physically active.\n-->\ne)  Examine the first case in the data set. Does your model underestimate or overestimate the weight of the individual? By how much?\n\n<!--\n$$\n    \\widehat{Weight}=-60.53-6.35(0)+0.87(172.2)\\\\\n    =89.28 Kgs\\\\\n    Residual = 82.2-89.28=-7.82\n$$\n-->\n\n\n## Problem 2 (Logistic Regression)\n\nMany studies show that being overweight increases one's risk of heart disease, stroke, type 2 diabetes, and other conditions. A common measure for determining whether someone is overweight is the Body Mass Index (BMI). BMI is a measure that accounts for both weight and height of an individual and is computed as follows:\n\n$$BMI=\\frac{Weight}{(Height)^2}$$\n\nWhere `weight` is measured in **Kilograms** and `Height` is measured in **meters**.\n\nIn this problem, you will use the same data set used in problem 1 to run a model for the likelihood of diabetes based on `BMI`, `Age`, and `Gender`. Note that the variable `Diabetes` is categorical with levels **Yes** and **No**.\n\na)  Create a regression model (name it `Diabetes_Model`) for predicting whether someone has diabetes or not based on their BMI, Age, and Gender. (Note: You may have to first mutate the Diabetes variable to use 1's and 0's. Check out the labs.\n<!--\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnhanes_samp_adult_500<- nhanes_samp_adult_500%>% \n  mutate(Diabetes_New = ifelse(Diabetes==\"Yes\", 1, 0) )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDiabetes_Model<- glm(Diabetes_New~BMI+Age+Gender, family=binomial, data =nhanes_samp_adult_500)\ntidy(Diabetes_Model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)  -9.00      1.12     -8.03   9.51e-16\n2 BMI           0.113     0.0212    5.32   1.04e- 7\n3 Age           0.0607    0.0110    5.53   3.13e- 8\n4 Gendermale    0.0172    0.315     0.0548 9.56e- 1\n```\n\n\n:::\n:::\n\n\n\n\n\n-->\nb)  Write down the equation of the model and interpret the coefficient for `Gender` and `BMI`.\n<!--\n$$\nln\\left(\\frac{p_i}{1-p_i}\\right)=-8.995 + 0.1127 (BMI) +0.0607 (Age) +0.01724 (GenderMale)\n$$\n\n-   Gender: On average, the log odds of having diabetes is higher by 0.01724 for males than for females when you control for BMI and Age.\n\n-   BMI: On average, for every additional BMI unit, the log odds of having diabetes increases by 0.1127 all else held constant.\n-->\nc)  James (male) is 57 years old, weighs 87.9 Kg, and is 156 cm tall. How would the `Diabetes_Model` classify this individual (Diabetes or No diabetes)?\n<!--\n-   First, we compute James' BMI using the equation given above:\n\n$$ JamesBMI =\\frac{87.9}{1.56^2} = 36.12 $$\n\n-   Next, we insert the variable values for James into the logistic model equation:\n\n$$\nln\\left(\\frac{p_i}{1-p_i}\\right)= -8.995 + 0.1127 (36.12) +0.0607 (57) + 0.01724 (1)= -1.45\n$$\n\n-   Finally, convert the log odds above to a probability:\n\n$$\np_{James}=\\frac{e^{-1.45}}{1+e^{-1.45}}=0.19\n$$ - Since the probability is less than 0.5, the model will classify James as **Non-diabetic**.\n-->\nd)  Create a confusion matrix to determine the accuracy of the `Diabetes_Model`.\n<!--\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAug_Diabetes_Model<- augment(Diabetes_Model, type.predict = \"response\")\n```\n:::\n\n\n\n\n\n\nCreate the augmented model now:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAug_Diabetes_ModelPlus <- Aug_Diabetes_Model %>%\n  mutate(diabetes_hat = round(.fitted))\n```\n:::\n\n\n\n\n\n\nCreate confusion matrix:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAug_Diabetes_ModelPlus %>%\n  select(Diabetes_New,diabetes_hat )%>%\n  table()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            diabetes_hat\nDiabetes_New   0   1\n           0 437   4\n           1  50   6\n```\n\n\n:::\n:::\n\n\n\n\n\n\n-   The total is 497 (all 0's and 1's). $Accuracy = \\frac{437+6}{437+4+50+6}=89.13\\%$.\n-->\n",
    "supporting": [
      "ps-3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}